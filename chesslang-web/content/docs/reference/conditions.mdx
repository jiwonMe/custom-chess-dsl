---
title: 조건 레퍼런스
description: ChessLang 조건 완전 레퍼런스
---

# 조건 레퍼런스

조건은 이동이 가능한 시점, 트리거가 발동하는 시점, 승리/무승부 조건이 적용되는 시점을 제한하는 데 사용됩니다.

## 이동 조건

이 조건들은 `where` 키워드와 함께 사용하여 기물 이동을 제한합니다.

### 칸 조건

| 조건 | 설명 | 예시 |
|------|------|------|
| `empty` | 대상 칸이 비어있음 | `step(forward) where empty` |
| `enemy` | 대상에 적 기물이 있음 | `step(diagonal) where enemy` |
| `friend` | 대상에 아군 기물이 있음 | `step(any) where friend` |

```chesslang
piece Pawn {
  move: step(forward) where empty
  capture: step(NE) | step(NW) where enemy   # 대각선 앞으로 잡기
}
```

### 경로 조건

| 조건 | 설명 | 예시 |
|------|------|------|
| `clear` | 경로가 막히지 않음 | `step(forward, 2) where clear` |

```chesslang
piece Pawn {
  move: step(forward, 2) where first_move and clear
}

piece Rook {
  move: slide(orthogonal)    # 막히면 암묵적으로 멈춤
}
```

### 기물 상태 조건

| 조건 | 설명 | 예시 |
|------|------|------|
| `first_move` | 기물이 아직 이동하지 않음 | `step(forward, 2) where first_move` |

```chesslang
piece Pawn {
  move: step(forward) where empty
  move: step(forward, 2) where first_move and clear and empty
}
```

### 게임 상태 조건

| 조건 | 설명 | 예시 |
|------|------|------|
| `check` | 킹이 체크 상태 | `move where check` |
| `not check` | 킹이 체크 상태가 아님 | `castle where not check` |

```chesslang
piece King {
  # 체크 중에는 캐슬링 불가
  move: castle where first_move and not check
}
```

### 존 조건

| 조건 | 설명 | 예시 |
|------|------|------|
| `in zone.X` | 위치가 존 X에 있음 | `target in zone.hill` |
| `on rank N` | 위치가 랭크 N에 있음 | `piece on rank 8` |
| `on file X` | 위치가 파일 X에 있음 | `piece on file e` |

```chesslang
board:
  zones:
    promotion: [a8, b8, c8, d8, e8, f8, g8, h8]

piece Pawn {
  move: step(forward) where target not in zone.promotion
  move: promote where target in zone.promotion
}
```

## 조건 조합

### 논리 연산자

| 연산자 | 설명 | 예시 |
|--------|------|------|
| `and` | 두 조건이 모두 참 | `first_move and clear` |
| `or` | 하나라도 참 | `empty or enemy` |
| `not` | 조건이 거짓 | `not check` |

```chesslang
piece Pawn {
  move: step(forward, 2) where first_move and clear and empty
}

piece King {
  move: castle where first_move and not check and clear
}
```

### 우선순위

1. `not` (가장 높음)
2. `and`
3. `or` (가장 낮음)

명확성을 위해 괄호를 사용하세요:

```chesslang
# 이것들은 동일합니다
step(any) where (empty or enemy) and not check
step(any) where empty or enemy and not check   # 우선순위로 인해 동일
```

## 승리 조건

승리 조건을 정의하기 위해 `victory` 섹션에서 사용됩니다.

### 조건 결합 규칙 (OR 로직)

> ⚠️ **중요:** 여러 승리 조건은 **OR로 결합**됩니다.
> 
> - 조건 중 **하나라도 만족**하면 게임이 종료됩니다.
> - AND 로직이 필요하면 **단일 조건 내**에서 `and`를 사용합니다.

| 액션 | 설명 | 결합 방식 |
|------|------|----------|
| `add` | 새 조건 추가 | 기존 조건 OR 새 조건 |
| `replace` | 같은 이름의 조건 교체 | OR 결합 유지 |
| `remove` | 조건 제거 | - |

### 내장 조건

| 조건 | 설명 |
|------|------|
| `checkmate` | 상대가 체크메이트 |
| `stalemate` | 상대가 합법적인 수가 없음 (기본적으로 무승부) |

### 기물 조건

| 조건 | 설명 | 예시 |
|------|------|------|
| `King captured` | 킹이 잡힘 | `victory: King captured` |
| `King in zone.X` | 킹이 존에 있음 | `King in zone.hill` |
| `King on rank N` | 킹이 랭크에 있음 | `King on rank 8` |
| `pieces == N` | 정확한 기물 수 | `opponent.pieces == 0` |
| `pieces <= N` | 기물 수 제한 | `opponent.pieces <= 1` |

```chesslang
# OR 결합: checkmate OR hill OR elimination 중 하나 만족시 승리
victory:
  add:
    hill: King in zone.hill
    elimination: opponent.pieces == 0
```

```chesslang
# AND 로직: 단일 조건 내에서 and 사용
victory:
  add:
    # 킹이 존에 있고 AND 기물이 1개일 때만 승리
    bare_king_hill: King in zone.hill and opponent.pieces == 1
```

### 카운터 조건

| 조건 | 설명 | 예시 |
|------|------|------|
| `checks >= N` | N회 이상 체크 | `checks >= 3` |
| `captures >= N` | N회 이상 잡기 | `captures >= 10` |
| `moves >= N` | N회 이상 이동 | `moves >= 50` |

```chesslang
# checkmate OR three_check 중 하나 만족시 승리
victory:
  add:
    three_check: checks >= 3
```

## 무승부 조건

무승부 조건을 정의하기 위해 `draw` 섹션에서 사용됩니다.

### 조건 결합 규칙 (OR 로직)

> ⚠️ **중요:** 승리 조건과 마찬가지로 여러 무승부 조건은 **OR로 결합**됩니다.
> 
> - 조건 중 **하나라도 만족**하면 무승부로 종료됩니다.

| 액션 | 설명 | 결합 방식 |
|------|------|----------|
| `add` | 새 조건 추가 | 기존 조건 OR 새 조건 |
| `replace` | 같은 이름의 조건 교체 | OR 결합 유지 |
| `remove` | 조건 제거 | - |

### 내장 무승부 조건

| 조건 | 설명 | 기본값 |
|------|------|--------|
| `stalemate` | 합법적인 수 없음 | 활성화 |
| `repetition` | 포지션 3회 반복 | 활성화 |
| `fifty_moves` | 50수 동안 잡기/폰 이동 없음 | 활성화 |
| `insufficient` | 불충분한 기물 | 활성화 |

```chesslang
# 기존 조건 교체
draw:
  replace:
    repetition: position_count >= 5      # 5회 반복으로 변경
```

### 커스텀 무승부 조건

```chesslang
# OR 결합: stalemate OR repetition OR ... OR bare_kings 중 하나 만족시 무승부
draw:
  add:
    bare_kings: White.pieces == 1 and Black.pieces == 1
```

```chesslang
# 특정 조건 제거
draw:
  remove:
    - stalemate     # 스테일메이트는 패배로 처리할 때
```

## 트리거 조건

트리거의 `when` 절에서 사용됩니다.

### 이벤트 데이터

| 변수 | 사용 가능 | 설명 |
|------|----------|------|
| `piece` | move, capture | 이동하는 기물 |
| `origin` | move, capture | 시작 위치 |
| `destination` | move, capture | 종료 위치 |
| `captured` | capture | 잡힌 기물 |
| `captured.owner` | capture | 잡힌 기물의 소유자 |
| `captured.type` | capture | 잡힌 기물의 타입 |

```chesslang
# 폰이 잡히면 좀비로 부활
trigger pawn_rises {
  on: capture
  when: captured.type == Pawn
  do: create Zombie at origin for captured.owner
}
```

### 기물 타입 조건

| 조건 | 설명 | 예시 |
|------|------|------|
| `piece.type == X` | 기물이 타입 X | `piece.type == Knight` |
| `piece.owner == X` | 기물이 X 소유 | `piece.owner == White` |

```chesslang
trigger knight_bonus {
  on: capture
  when: piece.type == Knight
  do: add_bonus(player, 1)
}
```

### 상태 조건

| 조건 | 설명 | 예시 |
|------|------|------|
| `piece.state.X == Y` | 상태 값 확인 | `piece.state.traps < 3` |
| `piece.state.X > N` | 상태 값 비교 | `piece.state.rage >= 3` |

```chesslang
trigger place_trap {
  on: move
  when: piece.type == Trapper and piece.state.traps < 3
  do: set piece.state.traps = piece.state.traps + 1
}
```

### 위치 조건

| 조건 | 설명 | 예시 |
|------|------|------|
| `X in zone.Y` | X가 존에 있음 | `King in zone.hill` |
| `destination in zone.X` | 도착지가 존에 있음 | `destination in zone.safe` |

```chesslang
trigger zone_victory {
  on: move
  when: piece.type == King and destination in zone.hill
  do: win piece.owner
}
```

### 비교 조건

조건에서 다양한 비교 연산을 사용할 수 있습니다:

| 조건 | 설명 | 예시 |
|------|------|------|
| `piece.type == X` | 기물 타입 비교 | `piece.type == Trapper` |
| `piece.owner == X` | 소유자 비교 | `piece.owner == White` |
| `piece.state.X < Y` | 상태 값 비교 | `piece.state.traps < 3` |

```chesslang
trigger trapper_action {
  on: move
  when: piece.type == Trapper and piece.state.traps < 3
  do: mark origin with trap
}
```

## 예시

### 조건부 이동

```chesslang
piece DesperatePawn {
  # 일반 이동
  move: step(forward) where empty

  # 첫 턴에 더블 무브
  move: step(forward, 2) where first_move and clear and empty

  # 대각선으로 잡기
  capture: step(NE) | step(NW) where enemy
}
```

### 조건부 트리거

```chesslang
trigger promote_on_hill {
  on: move
  when: piece.type == Pawn and destination in zone.hill
  do: transform piece to Queen
}

# 폰이 잡히면 좀비로 부활
trigger zombie_rise {
  on: capture
  when: captured.type == Pawn
  do: create Zombie at origin for captured.owner
}
```

### 승리 조건 예제

```chesslang
# King of the Hill - 중앙 점령
board:
  zones:
    hill: [d4, d5, e4, e5]

victory:
  add:
    hill: King in zone.hill

# Three-Check - 3회 체크
victory:
  add:
    three_checks: checks >= 3
```

## 참고

- [승리 & 무승부 조건](/docs/reference/victory-draw) - 조건 결합 규칙 상세 설명
- [액션 레퍼런스](/docs/reference/actions)
- [방향 레퍼런스](/docs/reference/directions)
- [레벨 2 - Compose](/docs/language/level2)
